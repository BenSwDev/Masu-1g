# תהליך ניהול המנויים

מסך זה מאפשר למנהל לעקוב ולערוך מנויי משתמשים קיימים או ליצור חדשים ידנית.

## תהליך טעינת הדף
1. בדיקת הרשאות עם `requireUserSession` והפניה חזרה אם המשתמש אינו מנהל.
2. קריאה ל־`getAllUserSubscriptions` שמחזירה אובייקט עם רשימת מנויים ומידע פאגינציה. הנתונים מועברים לרכיב הלקוח.
3. בזמן שהנתונים נטענים מופעל `ClientAwareUserSubscriptionsLoading` המציג שלדי טבלה או כרטיסים.

## ניהול נתונים וסטטיסטיקות
- הקובץ `admin-user-subscriptions-client.tsx` מחשב סטטיסטיקות בסיסיות (סה"כ מנויים, פעילים, שפגו והכנסות) על בסיס הנתונים שקיבל.
- ניתן לרענן את הנתונים בלחיצה על כפתור הרענון, שמפעיל את `getAllUserSubscriptions` מחדש ומציג Toast בהתאם.

## ניהול רשימת המנויים
- הרשימה מוצגת בטבלה במסכים רחבים או ככרטיסים בנייד. כל שורה/כרטיס משתמש ברכיבים `UserSubscriptionRow` או `UserSubscriptionAdminCard`.
- ניתן לחפש לפי שם/אימייל, לסנן לפי סטטוס ולהגדיר כמות תוצאות בעמוד.
- רכיב הפאגינציה מאפשר מעבר בין עמודים ובחירת מספר פריטים להצגה.

## פעולות CRUD
- יצירת מנוי חדש מתבצעת בטופס `CreateUserSubscriptionForm` שנפתח בדיאלוג. הטופס שולח את הנתונים ל־`createUserSubscription`.
- עריכת מנוי קיים נעשית דרך `UserSubscriptionForm` עם פעולה `updateUserSubscription`.
- ביטול מנוי וקבלתו מסומנים דרך `cancelSubscription` בקובץ הפעולות המשותף.
- מחיקה סופית של מנוי נעשית באמצעות `deleteUserSubscription` עם דיאלוג אישור.

## ולידציה ואימות
- הטפסים משתמשים ב־React Hook Form יחד עם סכמות Zod לבדיקת שדות כמו תאריך תפוגה וכמות מפגשים.
- פעולות השרת בודקות הרשאות משתמש ומאמתות את מזהי המסמכים עם Mongoose.

## ניהול מצב ומשוב
- מצבי טעינה ורענון מנוהלים במשתני `isLoading` ו־`isRefreshing` ברכיב הראשי.
- Toastים מספקים משוב לשגיאות או הצלחות בפעולות.
- במצב מובייל ובמסך ריק מוצגת הודעה מתורגמת שאין מנויים מתאימים.
